const descripcionesPersonalizadas = {
    1: "Maleta viajera, con compartimiento para PC, Diseño especializado, excelentes acabados.",
    2: "Camiseta premium con estilo casual. Ideal para cualquier ocasión, muy versátil.",
    3: "Chaqueta de algodón perfecta para el invierno. Diseño elegante y sofisticado.",
    4: "Camiseta slim fit de alta calidad.",
    5: "Pulsera de oro y plata con diseño único. DRAGON JADE.",
    6: "Anillo de ORO macizo. Estilo minimalista y duradero.",
    7: "Anillo Princess GOLD con diseño exclusivo. Para tus ocasiones especiales.",
    8: "Buho doble, de acero inoxidable en ORO ROSA.",
    9: "Disco duro portátil de 2T. Almacenamiento seguro para todos tus archivos.",
    10: "SSD ultra rápido para mejorar tu PC. Velocidad y rendimiento al máximo.",
    11: "Disco SSD de gran capacidad. Ideal para gamers y profesionales.",
    12: "Memoria USB con gran almacenamiento. Compacta y fácil de transportar.",
    13: "Pantalla marca ACER, FULL HD.",
    14: "Pantalla marca Samsung tipo CURVED Super Ultrawide.",
    15: "Chaqueta de invierno cálida y ligera. Perfecta para climas fríos.",
    16: "Chaqueta para moto con capucha desmontable.",
    17: "Chaqueta tiro largo para mujer, impermeable para esos viajes largos.",
    18: "Camiseta de manga corta versátil. Básico indispensable en tu armario.",
    19: "Camiseta deportiva de secado rápido. Comodidad durante todo el día.",
    20: "Blusa informal, para dias de relajación y comodidad."
};


const carrito = {
    items: [],
    
    agregarItem(producto) {
        const existe = this.items.find(item => item.id === producto.id);
        
        if (existe) {
            existe.cantidad++;
        } else {
            this.items.push({
                id: producto.id,
                title: producto.title,
                price: producto.price,
                descripcion: producto.descripcion,
                cantidad: 1
            });
        }
        
        this.renderizarCarrito();
        this.actualizarContador();
    },
    
    calcularTotal() {
        return this.items.reduce((total, item) => {
            return total + (item.price * item.cantidad);
        }, 0);
    },
    
    renderizarCarrito() {
        const carritoItems = document.getElementById('carrito-items');
        
        if (this.items.length === 0) {
            carritoItems.innerHTML = '<p style="text-align: center; color: #999;">Tu carrito está vacío</p>';
        } else {
            carritoItems.innerHTML = this.items.map(item => `
                <div class="carrito-item">
                    <h4>${item.title}</h4>
                    <p>${item.descripcion}</p>
                    <p><strong>Cantidad:</strong> ${item.cantidad}</p>
                    <p><strong>Precio:</strong> $${(item.price * item.cantidad).toFixed(2)}</p>
                </div>
            `).join('');
        }
        
        document.getElementById('carrito-total').textContent = this.calcularTotal().toFixed(2);
    },
    
    actualizarContador() {
        const totalItems = this.items.reduce((sum, item) => sum + item.cantidad, 0);
        document.getElementById('carrito-count').textContent = totalItems;
    }
};


async function loginAPI(username, password) {
    const response = await fetch("https://fakestoreapi.com/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, password })
    });
    return response.json();
}

document.getElementById('login-form').addEventListener('submit', (e) => {
    e.preventDefault();

    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;

    
    const usuarioValido = "Brayan";
    const passwordValida = "3123915523$";

    if (username === usuarioValido && password === passwordValida) {
        document.getElementById('login-section').style.display = 'none';
        document.getElementById('main-section').style.display = 'block';

        cargarProductos(); 
    } else {
        alert("Usuario o contraseña incorrectos");
    }
});



async function cargarProductos() {
    try {
        const response = await fetch('https://fakestoreapi.com/products');
        const productos = await response.json();
        
        renderizarProductos(productos);
    } catch (error) {
        console.error('Error al cargar productos:', error);
        document.getElementById('catalogo-productos').innerHTML = 
            '<p class="loading">Error al cargar los productos. Por favor recarga la página.</p>';
    }
}


function renderizarProductos(productos) {
    const catalogo = document.getElementById('catalogo-productos');
    
    catalogo.innerHTML = productos.map(producto => {
        const descripcionPersonalizada = descripcionesPersonalizadas[producto.id] || producto.description;
        
        return `
            <div class="producto-card">
                <img src="${producto.image}" alt="${producto.title}">
                <h3>${producto.title}</h3>
                <p>${descripcionPersonalizada}</p>
                <div class="precio">$${producto.price}</div>
                <button onclick="agregarAlCarrito(
                    ${producto.id},
                    '${producto.title.replace(/'/g, "\\'")}',
                    ${producto.price},
                    '${descripcionPersonalizada.replace(/'/g, "\\'")}',
                    '${producto.image}'
                )">
                    Añadir al Carrito
                </button>
            </div>
        `;
    }).join('');
}


function agregarAlCarrito(id, title, price, descripcion, image) {
    carrito.agregarItem({ id, title, price, descripcion, image });
    
    
    const btn = event.target;
    const textoOriginal = btn.textContent;
    btn.textContent = '✓ Agregado';
    btn.style.background = '#28a745';
    
    setTimeout(() => {
        btn.textContent = textoOriginal;
        btn.style.background = '#1a3092ff';
    }, 1000);
}


document.getElementById('ver-carrito-btn').addEventListener('click', () => {
    document.getElementById('carrito').classList.add('active');
});

document.getElementById('cerrar-carrito-btn').addEventListener('click', () => {
    document.getElementById('carrito').classList.remove('active');
});


document.getElementById('finalizar-compra').addEventListener('click', () => {
    if (carrito.items.length === 0) {
        alert('Tu carrito está vacío');
        return;
    }
    
    alert(`¡Compra realizada exitosamente!\n\nTotal: $${carrito.calcularTotal().toFixed(2)}\nProductos: ${carrito.items.reduce((sum, item) => sum + item.cantidad, 0)}`);
    
    
    carrito.items = [];
    carrito.renderizarCarrito();
    carrito.actualizarContador();
    document.getElementById('carrito').classList.remove('active');
});